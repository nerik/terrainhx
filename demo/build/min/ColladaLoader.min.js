THREE.ColladaLoader=function(){function e(e,r,s){var i=0;if(document.implementation&&document.implementation.createDocument){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState){if(0==a.status||200==a.status)if(a.responseXML)xt=r,t(a.responseXML,void 0,e);else if(a.responseText){xt=r;var n=new DOMParser,o=n.parseFromString(a.responseText,"application/xml");t(o,void 0,e)}else console.error("ColladaLoader: Empty or non-existing file ("+e+")")}else 3==a.readyState&&s&&(0==i&&(i=a.getResponseHeader("Content-Length")),s({total:i,loaded:a.responseText.length}))},a.open("GET",e,!0),a.send(null)}else alert("Don't know how to parse XML!")}function t(e,t,r){if(wt=e,t=t||xt,void 0!==r){var o=r.split("/");o.pop(),yt=(o.length<1?".":o.join("/"))+"/"}s(),lt(),Rt=i("//dae:library_images/dae:image",w,"image"),Ot=i("//dae:library_materials/dae:material",Y,"material"),At=i("//dae:library_effects/dae:effect",z,"effect"),Ct=i("//dae:library_geometries/dae:geometry",H,"geometry"),Ht=i(".//dae:library_cameras/dae:camera",K,"camera"),Mt=i("//dae:library_controllers/dae:controller",E,"controller"),_t=i("//dae:library_animations/dae:animation",q,"animation"),bt=i(".//dae:library_visual_scenes/dae:visual_scene",R,"visual_scene"),Tt=[],Nt=[],gt=a(),Et=new THREE.Object3D;for(var h=0;h<gt.nodes.length;h++)Et.add(p(gt.nodes[h]));Et.scale.multiplyScalar(It),n();var c={scene:Et,morphs:Tt,skins:Nt,animations:vt,dae:{images:Rt,materials:Ot,cameras:Ht,effects:At,geometries:Ct,controllers:Mt,animations:_t,visualScenes:bt,scene:gt}};return t&&t(c),c}function r(e){jt=e}function s(){var e=wt.evaluate("//dae:asset",wt,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),t=e.iterateNext();if(t&&t.childNodes)for(var r=0;r<t.childNodes.length;r++){var s=t.childNodes[r];switch(s.nodeName){case"unit":var i=s.getAttribute("meter");i&&(It=parseFloat(i));break;case"up_axis":Dt=s.textContent.charAt(0)}}}function i(e,t,r){for(var s=wt.evaluate(e,wt,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),i={},a=s.iterateNext(),n=0;a;){var o=(new t).parse(a);o.id&&0!=o.id.length||(o.id=r+n++),i[o.id]=o,a=s.iterateNext()}return i}function a(){var e=wt.evaluate(".//dae:scene/dae:instance_visual_scene",wt,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext();if(e){var t=e.getAttribute("url").replace(/^#/,"");return bt[t.length>0?t:"visual_scene0"]}return null}function n(){vt=[],o(Et)}function o(e){var t=gt.getChildById(e.name,!0),r=null;if(t&&t.keys){r={fps:60,hierarchy:[{node:t,keys:t.keys,sids:t.sids}],node:e,name:"animation_"+e.name,length:0},vt.push(r);for(var s=0,i=t.keys.length;i>s;s++)r.length=Math.max(r.length,t.keys[s].time)}else r={hierarchy:[{keys:[],sids:[]}]};for(var s=0,i=e.children.length;i>s;s++)for(var a=o(e.children[s]),n=0,h=a.hierarchy.length;h>n;n++)r.hierarchy.push({keys:[],sids:[]});return r}function h(){var e=1e6,t=-e,r=0;for(var s in _t)for(var i=_t[s],a=0;a<i.sampler.length;a++){var n=i.sampler[a];n.create(),e=Math.min(e,n.startTime),t=Math.max(t,n.endTime),r=Math.max(r,n.input.length)}return{start:e,end:t,frames:r}}function c(e,t){var r=t instanceof C?Mt[t.url]:t;if(!r||!r.morph)return console.log("could not find morph controller!"),void 0;for(var s=r.morph,i=0;i<s.targets.length;i++){var a=s.targets[i],n=Ct[a];if(n.mesh&&n.mesh.primitives&&n.mesh.primitives.length){var o=n.mesh.primitives[0].geometry;o.vertices.length===e.vertices.length&&e.morphTargets.push({name:"target_1",vertices:o.vertices})}}e.morphTargets.push({name:"target_Z",vertices:e.vertices})}function l(e,t,r,s){if(e.world=e.world||new THREE.Matrix4,e.world.copy(e.matrix),e.channels&&e.channels.length){var i=e.channels[0],a=i.sampler.output[r];a instanceof THREE.Matrix4&&e.world.copy(a)}s&&e.world.multiplyMatrices(s,e.world),t.push(e);for(var n=0;n<e.nodes.length;n++)l(e.nodes[n],t,r,e.world)}function d(e,t){for(var r=0;r<e.length;r++){var s=e[r],i=-1;if("JOINT"==s.type){for(var a=0;a<t.joints.length;a++)if(s.sid==t.joints[a]){i=a;break}if(!(i>=0))throw"ColladaLoader: Could not find joint '"+s.sid+"'.";var n=t.invBindMatrices[i];s.invBindMatrix=n,s.skinningMatrix=new THREE.Matrix4,s.skinningMatrix.multiplyMatrices(s.world,n),s.weights=[];for(var a=0;a<t.weights.length;a++)for(var o=0;o<t.weights[a].length;o++){var h=t.weights[a][o];h.joint==i&&s.weights.push(h)}}}}function u(e,t,r){var s=Mt[t.url];if(r=void 0!==r?r:40,!s||!s.skin)return console.log("ColladaLoader: Could not find skin controller."),void 0;if(!t.skeleton||!t.skeleton.length)return console.log("ColladaLoader: Could not find the skeleton for the skin. "),void 0;var i,a,n,o,c,u,p,f=h(),m=gt.getChildById(t.skeleton[0],!0)||gt.getChildBySid(t.skeleton[0],!0),g=new THREE.Vector3;for(i=0;i<e.vertices.length;i++)e.vertices[i].applyMatrix4(s.skin.bindShapeMatrix);for(r=0;r<f.frames;r++){var v=[],b=[];for(i=0;i<e.vertices.length;i++)b.push(new THREE.Vector3);for(l(m,v,r),d(v,s.skin),i=0;i<v.length;i++)if("JOINT"==v[i].type)for(a=0;a<v[i].weights.length;a++)n=v[i].weights[a],o=n.index,c=n.weight,u=e.vertices[o],p=b[o],g.x=u.x,g.y=u.y,g.z=u.z,g.applyMatrix4(v[i].skinningMatrix),p.x+=g.x*c,p.y+=g.y*c,p.z+=g.z*c;e.morphTargets.push({name:"target_"+r,vertices:b})}}function p(e){var t,r,s,i,a=new THREE.Object3D,n=!1;for(s=0;s<e.controllers.length;s++){var o=Mt[e.controllers[s].url];switch(o.type){case"skin":if(Ct[o.skin.source]){var h=new A;h.url=o.skin.source,h.instance_material=e.controllers[s].instance_material,e.geometries.push(h),n=!0,t=e.controllers[s]}else if(Mt[o.skin.source]){var l=Mt[o.skin.source];if(r=l,l.morph&&Ct[l.morph.source]){var h=new A;h.url=l.morph.source,h.instance_material=e.controllers[s].instance_material,e.geometries.push(h)}}break;case"morph":if(Ct[o.morph.source]){var h=new A;h.url=o.morph.source,h.instance_material=e.controllers[s].instance_material,e.geometries.push(h),r=e.controllers[s]}console.log("ColladaLoader: Morph-controller partially supported.")}}var d={};for(s=0;s<e.geometries.length;s++){var f,m=e.geometries[s],g=m.instance_material,v=Ct[m.url],b={},y=[],T=0;if(v){if(!v.mesh||!v.mesh.primitives)continue;if(0==a.name.length&&(a.name=v.id),g)for(i=0;i<g.length;i++){var N=g[i],w=Ot[N.target],E=w.instance_effect.url,x=At[E].shader,k=x.material;if(v.doubleSided){if(!(k in d)){var R=k.clone();R.side=THREE.DoubleSide,d[k]=R}k=d[k]}k.opacity=k.opacity?k.opacity:1,b[N.symbol]=T,y.push(k),f=k,f.name=null==w.name||""===w.name?w.id:w.name,T++}var _,M=f||new THREE.MeshLambertMaterial({color:14540253,shading:THREE.FlatShading,side:v.doubleSided?THREE.DoubleSide:THREE.FrontSide}),C=v.mesh.geometry3js;if(T>1)for(M=new THREE.MeshFaceMaterial(y),i=0;i<C.faces.length;i++){var O=C.faces[i];O.materialIndex=b[O.daeMaterial]}void 0!==t?(u(C,t),M.morphTargets=!0,_=new THREE.SkinnedMesh(C,M,!1),_.skeleton=t.skeleton,_.skinController=Mt[t.url],_.skinInstanceController=t,_.name="skin_"+Nt.length,Nt.push(_)):void 0!==r?(c(C,r),M.morphTargets=!0,_=new THREE.Mesh(C,M),_.name="morph_"+Tt.length,Tt.push(_)):_=new THREE.Mesh(C,M),e.geometries.length>1?a.add(_):a=_}}for(s=0;s<e.cameras.length;s++){var H=e.cameras[s],j=Ht[H.url];a=new THREE.PerspectiveCamera(j.fov,j.aspect_ratio,j.znear,j.zfar)}a.name=e.name||e.id||"",a.matrix=e.matrix;var S=e.matrix.decompose();if(a.position=S[0],a.quaternion=S[1],a.useQuaternion=!0,a.scale=S[2],St.centerGeometry&&a.geometry){var I=THREE.GeometryUtils.center(a.geometry);I.multiply(a.scale),I.applyQuaternion(a.quaternion),a.position.sub(I)}for(s=0;s<e.nodes.length;s++)a.add(p(e.nodes[s],e));return a}function f(e){return wt.evaluate(".//dae:library_nodes//dae:node[@id='"+e+"']",wt,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext()}function m(e){var t=[],r=1e6,s=-1e6;for(var i in _t)for(var a=_t[i],n=0;n<a.channel.length;n++){var o=a.channel[n],h=a.sampler[n],i=o.target.split("/")[0];i==e.id&&(h.create(),o.sampler=h,r=Math.min(r,h.startTime),s=Math.max(s,h.endTime),t.push(o))}return t.length&&(e.startTime=r,e.endTime=s),t}function g(e){if(e.channels&&e.channels.length){for(var t=[],r=[],s=0,i=e.channels.length;i>s;s++){var a,n=e.channels[s],o=n.fullSid,h=n.sampler,c=h.input,l=e.getTransformBySid(n.sid);if(n.arrIndices){a=[];for(var d=0,u=n.arrIndices.length;u>d;d++)a[d]=ft(n.arrIndices[d])}else a=mt(n.member);if(l){-1===r.indexOf(o)&&r.push(o);for(var d=0,u=c.length;u>d;d++){var p=c[d],f=h.getData(l.type,d),m=v(t,p);if(!m){m=new Q(p);var g=b(t,p);t.splice(-1==g?t.length:g,0,m)}m.addTarget(o,l,a,f)}}else console.log('Could not find transform "'+n.sid+'" in node '+e.id)}for(var s=0;s<r.length;s++)for(var T=r[s],d=0;d<t.length;d++){var m=t[d];m.hasTarget(T)||y(t,m,d,T)}e.keys=t,e.sids=r}}function v(e,t){for(var r=null,s=0,i=e.length;i>s&&null==r;s++){var a=e[s];if(a.time===t)r=a;else if(a.time>t)break}return r}function b(e,t){for(var r=-1,s=0,i=e.length;i>s&&-1==r;s++){var a=e[s];a.time>=t&&(r=s)}return r}function y(e,t,r,s){var i=N(e,s,r?r-1:0),a=T(e,s,r+1);if(i&&a){var n,o=(t.time-i.time)/(a.time-i.time),h=i.getTarget(s),c=a.getTarget(s).data,l=h.data;if("matrix"===h.type)n=l;else if(l.length){n=[];for(var d=0;d<l.length;++d)n[d]=l[d]+(c[d]-l[d])*o}else n=l+(c-l)*o;t.addTarget(s,h.transform,h.member,n)}}function T(e,t,r){for(;r<e.length;r++){var s=e[r];if(s.hasTarget(t))return s}return null}function N(e,t,r){for(r=r>=0?r:r+e.length;r>=0;r--){var s=e[r];if(s.hasTarget(t))return s}return null}function w(){this.id="",this.init_from=""}function E(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}function x(){this.method=null,this.source=null,this.targets=null,this.weights=null}function k(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}function R(){this.id="",this.name="",this.nodes=[],this.scene=new THREE.Object3D}function _(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new THREE.Matrix4}function M(){this.sid="",this.type="",this.data=[],this.obj=null}function C(){this.url="",this.skeleton=[],this.instance_material=[]}function O(){this.symbol="",this.target=""}function A(){this.url="",this.instance_material=[]}function H(){this.id="",this.mesh=null}function j(e){this.geometry=e.id,this.primitives=[],this.vertices=null,this.geometry3js=null}function S(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new THREE.Geometry}function I(){S.call(this),this.vcount=[]}function D(){S.call(this),this.vcount=3}function X(){this.source="",this.count=0,this.stride=0,this.params=[]}function F(){this.input={}}function B(){this.semantic="",this.offset=0,this.source="",this.set=0}function P(e){this.id=e,this.type=null}function Y(){this.id="",this.name="",this.instance_effect=null}function L(){this.color=new THREE.Color(0),this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function V(e,t){this.type=e,this.effect=t,this.material=null}function Z(e){this.effect=e,this.init_from=null,this.format=null}function U(e){this.effect=e,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function z(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function G(){this.url=""}function q(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}function W(e){this.animation=e,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}function J(e){this.id="",this.animation=e,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}function Q(e){this.targets=[],this.time=e}function K(){this.id="",this.name="",this.technique=""}function $(){this.url=""}function et(e){var t=e.getAttribute("id");return void 0!=kt[t]?kt[t]:(kt[t]=new P(t).parse(e),kt[t])}function tt(e){return"dae"==e?"http://www.collada.org/2005/11/COLLADASchema":null}function rt(e){for(var t=at(e),r=[],s=0,i=t.length;i>s;s++)r.push("true"==t[s]||"1"==t[s]?!0:!1);return r}function st(e){for(var t=at(e),r=[],s=0,i=t.length;i>s;s++)r.push(parseFloat(t[s]));return r}function it(e){for(var t=at(e),r=[],s=0,i=t.length;i>s;s++)r.push(parseInt(t[s],10));return r}function at(e){return e.length>0?nt(e).split(/\s+/):[]}function nt(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function ot(e,t,r){return e.hasAttribute(t)?parseInt(e.getAttribute(t),10):r}function ht(e,t){for(var r=wt.evaluate(t,e,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),s=r.iterateNext(),i=[];s;)i.push(s),s=r.iterateNext();return i}function ct(e,t){e.doubleSided=!1;var r=wt.evaluate(".//dae:extra//dae:double_sided",t,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);r&&(r=r.iterateNext(),r&&1===parseInt(r.textContent,10)&&(e.doubleSided=!0))}function lt(){if(St.convertUpAxis&&Dt!==St.upAxis)switch(Dt){case"X":Xt="Y"===St.upAxis?"XtoY":"XtoZ";break;case"Y":Xt="X"===St.upAxis?"YtoX":"YtoZ";break;case"Z":Xt="X"===St.upAxis?"ZtoX":"ZtoY"}else Xt=null}function dt(e,t){if(St.convertUpAxis&&Dt!==St.upAxis)switch(Xt){case"XtoY":var r=e[0];e[0]=t*e[1],e[1]=r;break;case"XtoZ":var r=e[2];e[2]=e[1],e[1]=e[0],e[0]=r;break;case"YtoX":var r=e[0];e[0]=e[1],e[1]=t*r;break;case"YtoZ":var r=e[1];e[1]=t*e[2],e[2]=r;break;case"ZtoX":var r=e[0];e[0]=e[1],e[1]=e[2],e[2]=r;break;case"ZtoY":var r=e[1];e[1]=e[2],e[2]=t*r}}function ut(e,t){var r=[e[t],e[t+1],e[t+2]];return dt(r,-1),new THREE.Vector3(r[0],r[1],r[2])}function pt(e){if(St.convertUpAxis){var t=[e[0],e[4],e[8]];dt(t,-1),e[0]=t[0],e[4]=t[1],e[8]=t[2],t=[e[1],e[5],e[9]],dt(t,-1),e[1]=t[0],e[5]=t[1],e[9]=t[2],t=[e[2],e[6],e[10]],dt(t,-1),e[2]=t[0],e[6]=t[1],e[10]=t[2],t=[e[0],e[1],e[2]],dt(t,-1),e[0]=t[0],e[1]=t[1],e[2]=t[2],t=[e[4],e[5],e[6]],dt(t,-1),e[4]=t[0],e[5]=t[1],e[6]=t[2],t=[e[8],e[9],e[10]],dt(t,-1),e[8]=t[0],e[9]=t[1],e[10]=t[2],t=[e[3],e[7],e[11]],dt(t,-1),e[3]=t[0],e[7]=t[1],e[11]=t[2]}return new THREE.Matrix4(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function ft(e){if(e>-1&&3>e){var t=["X","Y","Z"],r={X:0,Y:1,Z:2};e=mt(t[e]),e=r[e]}return e}function mt(e){if(St.convertUpAxis)switch(e){case"X":switch(Xt){case"XtoY":case"XtoZ":case"YtoX":e="Y";break;case"ZtoX":e="Z"}break;case"Y":switch(Xt){case"XtoY":case"YtoX":case"ZtoX":e="X";break;case"XtoZ":case"YtoZ":case"ZtoY":e="Z"}break;case"Z":switch(Xt){case"XtoZ":e="X";break;case"YtoZ":case"ZtoX":case"ZtoY":e="Y"}}return e}var gt,vt,bt,yt,Tt,Nt,wt=null,Et=null,xt=null,kt={},Rt={},_t={},Mt={},Ct={},Ot={},At={},Ht={},jt=THREE.SmoothShading,St={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},It=1,Dt="Y",Xt=null;return w.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];"init_from"==r.nodeName&&(this.init_from=r.textContent)}return this},E.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.type="none";for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"skin":this.skin=(new k).parse(r),this.type=r.nodeName;break;case"morph":this.morph=(new x).parse(r),this.type=r.nodeName}}return this},x.prototype.parse=function(e){var t,r={},s=[];for(this.method=e.getAttribute("method"),this.source=e.getAttribute("source").replace(/^#/,""),t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];if(1==i.nodeType)switch(i.nodeName){case"source":var a=(new P).parse(i);r[a.id]=a;break;case"targets":s=this.parseInputs(i);break;default:console.log(i.nodeName)}}for(t=0;t<s.length;t++){var n=s[t],a=r[n.source];switch(n.semantic){case"MORPH_TARGET":this.targets=a.read();break;case"MORPH_WEIGHT":this.weights=a.read()}}return this},x.prototype.parseInputs=function(e){for(var t=[],r=0;r<e.childNodes.length;r++){var s=e.childNodes[r];if(1==s.nodeType)switch(s.nodeName){case"input":t.push((new B).parse(s))}}return t},k.prototype.parse=function(e){var t,r,s={};this.source=e.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var i=0;i<e.childNodes.length;i++){var a=e.childNodes[i];if(1==a.nodeType)switch(a.nodeName){case"bind_shape_matrix":var n=st(a.textContent);this.bindShapeMatrix=pt(n);break;case"source":var o=(new P).parse(a);s[o.id]=o;break;case"joints":t=a;break;case"vertex_weights":r=a;break;default:console.log(a.nodeName)}}return this.parseJoints(t,s),this.parseWeights(r,s),this},k.prototype.parseJoints=function(e,t){for(var r=0;r<e.childNodes.length;r++){var s=e.childNodes[r];if(1==s.nodeType)switch(s.nodeName){case"input":var i=(new B).parse(s),a=t[i.source];"JOINT"==i.semantic?this.joints=a.read():"INV_BIND_MATRIX"==i.semantic&&(this.invBindMatrices=a.read())}}},k.prototype.parseWeights=function(e,t){for(var r,s,i=[],a=0;a<e.childNodes.length;a++){var n=e.childNodes[a];if(1==n.nodeType)switch(n.nodeName){case"input":i.push((new B).parse(n));break;case"v":r=it(n.textContent);break;case"vcount":s=it(n.textContent)}}for(var o=0,a=0;a<s.length;a++){for(var h=s[a],c=[],l=0;h>l;l++){for(var d={},u=0;u<i.length;u++){var p=i[u],f=r[o+p.offset];switch(p.semantic){case"JOINT":d.joint=f;break;case"WEIGHT":d.weight=t[p.source].data[f]}}c.push(d),o+=i.length}for(var l=0;l<c.length;l++)c[l].index=a;this.weights.push(c)}},R.prototype.getChildById=function(e,t){for(var r=0;r<this.nodes.length;r++){var s=this.nodes[r].getChildById(e,t);if(s)return s}return null},R.prototype.getChildBySid=function(e,t){for(var r=0;r<this.nodes.length;r++){var s=this.nodes[r].getChildBySid(e,t);if(s)return s}return null},R.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.nodes=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"node":this.nodes.push((new _).parse(r))}}return this},_.prototype.getChannelForTransform=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t],s=r.target.split("/");s.shift();var i,a,n=s.shift(),o=n.indexOf(".")>=0,h=n.indexOf("(")>=0;if(o)s=n.split("."),n=s.shift(),a=s.shift();else if(h){i=n.split("("),n=i.shift();for(var c=0;c<i.length;c++)i[c]=parseInt(i[c].replace(/\)/,""))}if(n==e)return r.info={sid:n,dotSyntax:o,arrSyntax:h,arrIndices:i},r}return null},_.prototype.getChildById=function(e,t){if(this.id==e)return this;if(t)for(var r=0;r<this.nodes.length;r++){var s=this.nodes[r].getChildById(e,t);if(s)return s}return null},_.prototype.getChildBySid=function(e,t){if(this.sid==e)return this;if(t)for(var r=0;r<this.nodes.length;r++){var s=this.nodes[r].getChildBySid(e,t);if(s)return s}return null},_.prototype.getTransformBySid=function(e){for(var t=0;t<this.transforms.length;t++)if(this.transforms[t].sid==e)return this.transforms[t];return null},_.prototype.parse=function(e){var t;this.id=e.getAttribute("id"),this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.type=e.getAttribute("type"),this.type="JOINT"==this.type?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.controllers=[],this.matrix=new THREE.Matrix4;for(var r=0;r<e.childNodes.length;r++){var s=e.childNodes[r];if(1==s.nodeType)switch(s.nodeName){case"node":this.nodes.push((new _).parse(s));break;case"instance_camera":this.cameras.push((new $).parse(s));break;case"instance_controller":this.controllers.push((new C).parse(s));break;case"instance_geometry":this.geometries.push((new A).parse(s));break;case"instance_light":break;case"instance_node":t=s.getAttribute("url").replace(/^#/,"");var i=f(t);i&&this.nodes.push((new _).parse(i));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new M).parse(s));break;case"extra":break;default:console.log(s.nodeName)}}return this.channels=m(this),g(this),this.updateMatrix(),this},_.prototype.updateMatrix=function(){this.matrix.identity();for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(this.matrix)},M.prototype.parse=function(e){return this.sid=e.getAttribute("sid"),this.type=e.nodeName,this.data=st(e.textContent),this.convert(),this},M.prototype.convert=function(){switch(this.type){case"matrix":this.obj=pt(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":dt(this.data,-1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":dt(this.data,1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},M.prototype.apply=function(e){switch(this.type){case"matrix":e.multiply(this.obj);break;case"translate":e.translate(this.obj);break;case"rotate":e.rotateByAxis(this.obj,this.angle);break;case"scale":e.scale(this.obj)}},M.prototype.update=function(e,t){var r=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(t)if(1===t.length)switch(t[0]){case 0:this.obj.n11=e[0],this.obj.n21=e[1],this.obj.n31=e[2],this.obj.n41=e[3];break;case 1:this.obj.n12=e[0],this.obj.n22=e[1],this.obj.n32=e[2],this.obj.n42=e[3];break;case 2:this.obj.n13=e[0],this.obj.n23=e[1],this.obj.n33=e[2],this.obj.n43=e[3];break;case 3:this.obj.n14=e[0],this.obj.n24=e[1],this.obj.n34=e[2],this.obj.n44=e[3]}else if(2===t.length){var s="n"+(t[0]+1)+(t[1]+1);this.obj[s]=e}else console.log("Incorrect addressing of matrix in transform.");else this.obj.copy(e);break;case"translate":case"scale":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=r[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2]}break;case"rotate":switch("[object Array]"===Object.prototype.toString.call(t)&&(t=r[t[0]]),t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;case"ANGLE":this.angle=THREE.Math.degToRad(e);break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2],this.angle=THREE.Math.degToRad(e[3])}}},C.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1===r.nodeType)switch(r.nodeName){case"skeleton":this.skeleton.push(r.textContent.replace(/^#/,""));break;case"bind_material":var s=wt.evaluate(".//dae:instance_material",r,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(s)for(var i=s.iterateNext();i;)this.instance_material.push((new O).parse(i)),i=s.iterateNext();break;case"extra":}}return this},O.prototype.parse=function(e){return this.symbol=e.getAttribute("symbol"),this.target=e.getAttribute("target").replace(/^#/,""),this},A.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType&&"bind_material"==r.nodeName){var s=wt.evaluate(".//dae:instance_material",r,tt,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(s)for(var i=s.iterateNext();i;)this.instance_material.push((new O).parse(i)),i=s.iterateNext();break}}return this},H.prototype.parse=function(e){this.id=e.getAttribute("id"),ct(this,e);for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"mesh":this.mesh=new j(this).parse(r);break;case"extra":}}return this},j.prototype.parse=function(e){this.primitives=[];var t;for(t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"source":et(r);break;case"vertices":this.vertices=(new F).parse(r);break;case"triangles":this.primitives.push((new D).parse(r));break;case"polygons":this.primitives.push((new S).parse(r));break;case"polylist":this.primitives.push((new I).parse(r))}}this.geometry3js=new THREE.Geometry;var s=kt[this.vertices.input.POSITION.source].data;for(t=0;t<s.length;t+=3)this.geometry3js.vertices.push(ut(s,t).clone());for(t=0;t<this.primitives.length;t++){var i=this.primitives[t];i.setVertices(this.vertices),this.handlePrimitive(i,this.geometry3js)}return this.geometry3js.computeCentroids(),this.geometry3js.computeFaceNormals(),this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this.geometry3js.computeBoundingBox(),this},j.prototype.handlePrimitive=function(e,t){var r,s,i,a,n,o,h,c=e.p,l=e.inputs,d=0,u=3,p=0,f=[];for(r=0;r<l.length;r++){i=l[r];var m=i.offset+1;switch(p=m>p?m:p,i.semantic){case"TEXCOORD":f.push(i.set)}}for(var g=0;g<c.length;++g)for(var v=c[g],b=0;b<v.length;){var y=[],T=[],N=null,w=[];for(u=e.vcount?e.vcount.length?e.vcount[d++]:e.vcount:v.length/p,r=0;u>r;r++)for(s=0;s<l.length;s++)switch(i=l[s],o=kt[i.source],a=v[b+r*p+i.offset],h=o.accessor.params.length,n=a*h,i.semantic){case"VERTEX":y.push(a);break;case"NORMAL":T.push(ut(o.data,n));break;case"TEXCOORD":N=N||{},void 0===N[i.set]&&(N[i.set]=[]),N[i.set].push(new THREE.Vector2(o.data[n],o.data[n+1]));break;case"COLOR":w.push((new THREE.Color).setRGB(o.data[n],o.data[n+1],o.data[n+2]))}if(0==T.length)if(i=this.vertices.input.NORMAL){o=kt[i.source],h=o.accessor.params.length;for(var E=0,x=y.length;x>E;E++)T.push(ut(o.data,y[E]*h))}else t.calcNormals=!0;if(!N&&(N={},i=this.vertices.input.TEXCOORD)){f.push(i.set),o=kt[i.source],h=o.accessor.params.length;for(var E=0,x=y.length;x>E;E++)n=y[E]*h,void 0===N[i.set]&&(N[i.set]=[]),N[i.set].push(new THREE.Vector2(o.data[n],1-o.data[n+1]))}if(0==w.length&&(i=this.vertices.input.COLOR)){o=kt[i.source],h=o.accessor.params.length;for(var E=0,x=y.length;x>E;E++)n=y[E]*h,w.push((new THREE.Color).setRGB(o.data[n],o.data[n+1],o.data[n+2]))}var k,R,_=null,M=[];if(3===u)M.push(new THREE.Face3(y[0],y[1],y[2],T,w.length?w:new THREE.Color));else if(4===u)M.push(new THREE.Face4(y[0],y[1],y[2],y[3],T,w.length?w:new THREE.Color));else if(u>4&&St.subdivideFaces){var C=w.length?w:new THREE.Color;for(s=1;u-1>s;)M.push(new THREE.Face3(y[0],y[s],y[s+1],[T[0],T[s++],T[s]],C))}if(M.length)for(var E=0,x=M.length;x>E;E++)for(_=M[E],_.daeMaterial=e.material,t.faces.push(_),s=0;s<f.length;s++)k=N[f[s]],R=u>4?[k[0],k[E+1],k[E+2]]:4===u?[k[0],k[1],k[2],k[3]]:[k[0],k[1],k[2]],t.faceVertexUvs[s]||(t.faceVertexUvs[s]=[]),t.faceVertexUvs[s].push(R);else console.log("dropped face with vcount "+u+" for geometry with id: "+t.id);b+=p*u}},S.prototype.setVertices=function(e){for(var t=0;t<this.inputs.length;t++)this.inputs[t].source==e.id&&(this.inputs[t].source=e.input.POSITION.source)},S.prototype.parse=function(e){this.material=e.getAttribute("material"),this.count=ot(e,"count",0);for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"input":this.inputs.push((new B).parse(e.childNodes[t]));break;case"vcount":this.vcount=it(r.textContent);break;case"p":this.p.push(it(r.textContent));break;case"ph":console.warn("polygon holes not yet supported!")}}return this},I.prototype=Object.create(S.prototype),D.prototype=Object.create(S.prototype),X.prototype.parse=function(e){this.params=[],this.source=e.getAttribute("source"),this.count=ot(e,"count",0),this.stride=ot(e,"stride",0);for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if("param"==r.nodeName){var s={};s.name=r.getAttribute("name"),s.type=r.getAttribute("type"),this.params.push(s)}}return this},F.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++)if("input"==e.childNodes[t].nodeName){var r=(new B).parse(e.childNodes[t]);this.input[r.semantic]=r}return this},B.prototype.parse=function(e){return this.semantic=e.getAttribute("semantic"),this.source=e.getAttribute("source").replace(/^#/,""),this.set=ot(e,"set",-1),this.offset=ot(e,"offset",0),"TEXCOORD"==this.semantic&&this.set<0&&(this.set=0),this},P.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"bool_array":this.data=rt(r.textContent),this.type=r.nodeName;break;case"float_array":this.data=st(r.textContent),this.type=r.nodeName;break;case"int_array":this.data=it(r.textContent),this.type=r.nodeName;break;case"IDREF_array":case"Name_array":this.data=at(r.textContent),this.type=r.nodeName;break;case"technique_common":for(var s=0;s<r.childNodes.length;s++)if("accessor"==r.childNodes[s].nodeName){this.accessor=(new X).parse(r.childNodes[s]);break}}}return this},P.prototype.read=function(){var e=[],t=this.accessor.params[0];switch(t.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var r=0;r<this.data.length;r+=16){var s=this.data.slice(r,r+16),i=pt(s);e.push(i)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+t.type+".")}return e},Y.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++)if("instance_effect"==e.childNodes[t].nodeName){this.instance_effect=(new G).parse(e.childNodes[t]);break}return this},L.prototype.isColor=function(){return null==this.texture},L.prototype.isTexture=function(){return null!=this.texture},L.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"color":var s=st(r.textContent);this.color=new THREE.Color(0),this.color.setRGB(s[0],s[1],s[2]),this.color.a=s[3];break;case"texture":this.texture=r.getAttribute("texture"),this.texcoord=r.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(r)}}return this},L.prototype.parseTexture=function(e){if(!e.childNodes)return this;e.childNodes[1]&&"extra"===e.childNodes[1].nodeName&&(e=e.childNodes[1],e.childNodes[1]&&"technique"===e.childNodes[1].nodeName&&(e=e.childNodes[1]));for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[r.nodeName]=parseFloat(r.textContent);break;case"wrapU":case"wrapV":this.texOpts[r.nodeName]=parseInt(r.textContent);break;default:this.texOpts[r.nodeName]=r.textContent}}return this},V.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"ambient":case"emission":case"diffuse":case"specular":case"transparent":this[r.nodeName]=(new L).parse(r);break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var s=ht(r,".//dae:float");s.length>0&&(this[r.nodeName]=parseFloat(s[0].textContent))}}return this.create(),this},V.prototype.create=function(){var e={},t=void 0!==this.transparency&&this.transparency<1;for(var r in this)switch(r){case"ambient":case"emission":case"diffuse":case"specular":var s=this[r];if(s instanceof L)if(s.isTexture()){var i=s.texture,a=this.effect.sampler[i].source;if(a){var n=this.effect.surface[a],o=Rt[n.init_from];if(o){var h=THREE.ImageUtils.loadTexture(yt+o.init_from);h.wrapS=s.texOpts.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,h.wrapT=s.texOpts.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,h.offset.x=s.texOpts.offsetU,h.offset.y=s.texOpts.offsetV,h.repeat.x=s.texOpts.repeatU,h.repeat.y=s.texOpts.repeatV,e.map=h,"emission"===r&&(e.emissive=16777215)}}}else"diffuse"!==r&&t||("emission"===r?e.emissive=s.color.getHex():e[r]=s.color.getHex());break;case"shininess":e[r]=this[r];break;case"reflectivity":e[r]=this[r],e[r]>0&&(e.envMap=St.defaultEnvMap),e.combine=THREE.MixOperation;break;case"index_of_refraction":e.refractionRatio=this[r],1!==this[r]&&(e.envMap=St.defaultEnvMap);break;case"transparency":t&&(e.transparent=!0,e.opacity=this[r],t=!0)}switch(e.shading=jt,e.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide,this.type){case"constant":void 0!=e.emissive&&(e.color=e.emissive),this.material=new THREE.MeshBasicMaterial(e);break;case"phong":case"blinn":void 0!=e.diffuse&&(e.color=e.diffuse),this.material=new THREE.MeshPhongMaterial(e);break;case"lambert":default:void 0!=e.diffuse&&(e.color=e.diffuse),this.material=new THREE.MeshLambertMaterial(e)}return this.material},Z.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];
if(1==r.nodeType)switch(r.nodeName){case"init_from":this.init_from=r.textContent;break;case"format":this.format=r.textContent;break;default:console.log("unhandled Surface prop: "+r.nodeName)}}return this},U.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"source":this.source=r.textContent;break;case"minfilter":this.minfilter=r.textContent;break;case"magfilter":this.magfilter=r.textContent;break;case"mipfilter":this.mipfilter=r.textContent;break;case"wrap_s":this.wrap_s=r.textContent;break;case"wrap_t":this.wrap_t=r.textContent;break;default:console.log("unhandled Sampler2D prop: "+r.nodeName)}}return this},z.prototype.create=function(){return null==this.shader?null:void 0},z.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),ct(this,e),this.shader=null;for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(r))}}return this},z.prototype.parseNewparam=function(e){for(var t=e.getAttribute("sid"),r=0;r<e.childNodes.length;r++){var s=e.childNodes[r];if(1==s.nodeType)switch(s.nodeName){case"surface":this.surface[t]=new Z(this).parse(s);break;case"sampler2D":this.sampler[t]=new U(this).parse(s);break;case"extra":break;default:console.log(s.nodeName)}}},z.prototype.parseProfileCOMMON=function(e){for(var t,r=0;r<e.childNodes.length;r++){var s=e.childNodes[r];if(1==s.nodeType)switch(s.nodeName){case"profile_COMMON":this.parseProfileCOMMON(s);break;case"technique":t=s;break;case"newparam":this.parseNewparam(s);break;case"image":var i=(new w).parse(s);Rt[i.id]=i;break;case"extra":break;default:console.log(s.nodeName)}}return t},z.prototype.parseTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new V(r.nodeName,this).parse(r)}}},G.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},q.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.source={};for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"animation":var s=(new q).parse(r);for(var i in s.source)this.source[i]=s.source[i];for(var a=0;a<s.channel.length;a++)this.channel.push(s.channel[a]),this.sampler.push(s.sampler[a]);break;case"source":var i=(new P).parse(r);this.source[i.id]=i;break;case"sampler":this.sampler.push(new J(this).parse(r));break;case"channel":this.channel.push(new W(this).parse(r))}}return this},W.prototype.parse=function(e){this.source=e.getAttribute("source").replace(/^#/,""),this.target=e.getAttribute("target");var t=this.target.split("/");t.shift();var r=t.shift(),s=r.indexOf(".")>=0,i=r.indexOf("(")>=0;if(s)t=r.split("."),this.sid=t.shift(),this.member=t.shift();else if(i){var a=r.split("(");this.sid=a.shift();for(var n=0;n<a.length;n++)a[n]=parseInt(a[n].replace(/\)/,""));this.arrIndices=a}else this.sid=r;return this.fullSid=r,this.dotSyntax=s,this.arrSyntax=i,this},J.prototype.parse=function(e){this.id=e.getAttribute("id"),this.inputs=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"input":this.inputs.push((new B).parse(r))}}return this},J.prototype.create=function(){for(var e=0;e<this.inputs.length;e++){var t=this.inputs[e],r=this.animation.source[t.source];switch(t.semantic){case"INPUT":this.input=r.read();break;case"OUTPUT":this.output=r.read(),this.strideOut=r.accessor.stride;break;case"INTERPOLATION":this.interpolation=r.read();break;case"IN_TANGENT":break;case"OUT_TANGENT":break;default:console.log(t.semantic)}}if(this.startTime=0,this.endTime=0,this.duration=0,this.input.length){this.startTime=1e8,this.endTime=-1e8;for(var e=0;e<this.input.length;e++)this.startTime=Math.min(this.startTime,this.input[e]),this.endTime=Math.max(this.endTime,this.input[e]);this.duration=this.endTime-this.startTime}},J.prototype.getData=function(e,t){var r;if("matrix"===e&&16===this.strideOut)r=this.output[t];else if(this.strideOut>1){r=[],t*=this.strideOut;for(var s=0;s<this.strideOut;++s)r[s]=this.output[t+s];if(3===this.strideOut)switch(e){case"rotate":case"translate":dt(r,-1);break;case"scale":dt(r,1)}else 4===this.strideOut&&"matrix"===e&&dt(r,-1)}else r=this.output[t];return r},Q.prototype.addTarget=function(e,t,r,s){this.targets.push({sid:e,member:r,transform:t,data:s})},Q.prototype.apply=function(e){for(var t=0;t<this.targets.length;++t){var r=this.targets[t];e&&r.sid!==e||r.transform.update(r.data,r.member)}},Q.prototype.getTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return this.targets[t];return null},Q.prototype.hasTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return!0;return!1},Q.prototype.interpolate=function(e,t){for(var r=0;r<this.targets.length;++r){var s,i=this.targets[r],a=e.getTarget(i.sid);if("matrix"!==i.transform.type&&a){var n=(t-this.time)/(e.time-this.time),o=a.data,h=i.data;if((0>n||n>1)&&(console.log("Key.interpolate: Warning! Scale out of bounds:"+n),n=0>n?0:1),h.length){s=[];for(var c=0;c<h.length;++c)s[c]=h[c]+(o[c]-h[c])*n}else s=h+(o-h)*n}else s=i.data;i.transform.update(s,i.member)}},K.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(1==r.nodeType)switch(r.nodeName){case"optics":this.parseOptics(r)}}return this},K.prototype.parseOptics=function(e){for(var t=0;t<e.childNodes.length;t++)if("technique_common"==e.childNodes[t].nodeName)for(var r=e.childNodes[t],s=0;s<r.childNodes.length;s++)if(this.technique=r.childNodes[s].nodeName,"perspective"==this.technique)for(var i=r.childNodes[s],a=0;a<i.childNodes.length;a++){var n=i.childNodes[a];switch(n.nodeName){case"yfov":this.yfov=n.textContent;break;case"xfov":this.xfov=n.textContent;break;case"znear":this.znear=n.textContent;break;case"zfar":this.zfar=n.textContent;break;case"aspect_ratio":this.aspect_ratio=n.textContent}}else if("orthographic"==this.technique)for(var o=r.childNodes[s],a=0;a<o.childNodes.length;a++){var n=o.childNodes[a];switch(n.nodeName){case"xmag":this.xmag=n.textContent;break;case"ymag":this.ymag=n.textContent;break;case"znear":this.znear=n.textContent;break;case"zfar":this.zfar=n.textContent;break;case"aspect_ratio":this.aspect_ratio=n.textContent}}return this},$.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},{load:e,parse:t,setPreferredShading:r,applySkin:u,geometries:Ct,options:St}};